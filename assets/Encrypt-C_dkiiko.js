import{u as T,i as E}from"./action-YmMChBHQ.js";import{d as $,L as w,M as z,T as a,D as A,c as H,w as p,r as l,x as n,j as r,Q as I,O as K,a as U}from"./tool-B4oZh9Hj.js";import{a as d}from"./index-CPoQnu_J.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-monaco-DSX5bDTJ.js";import"./vendor-lodash-rhkwYG98.js";import"./vendor-crypto-Bb1b9cxO.js";const M=$({__name:"Encrypt",async setup(B){let i,s;const e=T(([i,s]=w(()=>E({input:K("text"),option:{public_key:"",private_key:"",cipher_mode:1},output:I("hex")})),i=await i,s(),i)),m=z(()=>{if(e.current.input.text.isEmpty()||e.current.option.public_key==="")return a.empty();if(e.current.input.text.isError())return e.current.input.text;try{let t=e.current.option.public_key;if(t.length==128)t="04"+t;else if(t.length!=130||!t.startsWith("04"))return a.fromError($error($t("public_key_error")));const o=d.sm2.doEncrypt(e.current.input.text.toArray(),t,e.current.option.cipher_mode);return a.fromHex(o)}catch(t){return a.fromError($error(t))}});A(()=>m.value,t=>{t.isEmpty()||e.save()},{immediate:!0,deep:!0});const y=()=>{const t=d.sm2.generateKeyPairHex();e.current.option.public_key=t.publicKey,e.current.option.private_key=t.privateKey};return(t,o)=>{const f=l("TextInput"),_=l("Input"),c=l("Align"),x=l("Select"),k=l("Button"),b=l("HelpTip"),g=l("Card"),h=l("TextOutput"),V=l("HeightResize");return U(),H(V,{ignore:"",append:[".ctool-page-option"],reduce:10},{default:p(({small:v,large:C})=>[n(c,{direction:"vertical"},{default:p(()=>[n(f,{modelValue:r(e).current.input,"onUpdate:modelValue":o[0]||(o[0]=u=>r(e).current.input=u),height:v,upload:"file"},null,8,["modelValue","height"]),n(g,{title:t.$t("main_ui_config"),class:"ctool-page-option"},{extra:p(()=>[n(c,null,{default:p(()=>[n(x,{size:"small",options:[{value:1,label:"C1-C3-C2"},{value:0,label:"C1-C2-C3"}],modelValue:r(e).current.option.cipher_mode,"onUpdate:modelValue":o[3]||(o[3]=u=>r(e).current.option.cipher_mode=u)},null,8,["modelValue"]),n(k,{type:"primary",size:"small",text:t.$t("sm2_generate_keypair"),onClick:y},null,8,["text"]),n(b,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:p(()=>[n(c,{horizontal:"center"},{default:p(()=>[n(_,{modelValue:r(e).current.option.public_key,"onUpdate:modelValue":o[1]||(o[1]=u=>r(e).current.option.public_key=u),label:t.$t("sm2_public_key")},null,8,["modelValue","label"]),n(_,{modelValue:r(e).current.option.private_key,"onUpdate:modelValue":o[2]||(o[2]=u=>r(e).current.option.private_key=u),label:t.$t("sm2_private_key")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["title"]),n(h,{modelValue:r(e).current.output,"onUpdate:modelValue":o[4]||(o[4]=u=>r(e).current.output=u),allow:["base64","hex"],content:m.value,height:C},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1})}}});export{M as default};
