import{u as v,i as T}from"./action-YmMChBHQ.js";import{d as k,L as I,M as b,T as s,D as w,c as A,w as p,r as i,x as e,j as n,Q as C,O as E,a as H}from"./tool-B4oZh9Hj.js";import{a as z}from"./index-CPoQnu_J.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-monaco-DSX5bDTJ.js";import"./vendor-lodash-rhkwYG98.js";import"./vendor-crypto-Bb1b9cxO.js";const J=k({__name:"Sign",async setup(O){let a,m;const t=v(([a,m]=I(()=>T({input:E("text"),option:{private_key:"",user_id:"1234567812345678"},output:C("hex")})),a=await a,m(),a)),c=b(()=>{if(t.current.input.text.isEmpty()||t.current.option.private_key==="")return s.empty();if(t.current.input.text.isError())return t.current.input.text;try{return s.fromHex(z.sm2.doSignature(t.current.input.text.toArray(),t.current.option.private_key,{hash:!0,userId:t.current.option.user_id}))}catch(r){return s.fromError($error(r))}});return w(()=>c.value,r=>{r.isEmpty()||t.save()},{immediate:!0,deep:!0}),(r,o)=>{const _=i("TextInput"),d=i("Input"),l=i("Align"),f=i("HelpTip"),x=i("Card"),g=i("TextOutput"),h=i("HeightResize");return H(),A(h,{ignore:"",append:[".ctool-page-option"],reduce:10},{default:p(({small:y,large:V})=>[e(l,{direction:"vertical"},{default:p(()=>[e(_,{modelValue:n(t).current.input,"onUpdate:modelValue":o[0]||(o[0]=u=>n(t).current.input=u),height:y,upload:"file"},null,8,["modelValue","height"]),e(x,{title:r.$t("main_ui_config"),class:"ctool-page-option"},{extra:p(()=>[e(l,null,{default:p(()=>[e(f,{link:"https://github.com/JuneAndGreen/sm-crypto"})]),_:1})]),default:p(()=>[e(l,{horizontal:"center"},{default:p(()=>[e(d,{modelValue:n(t).current.option.private_key,"onUpdate:modelValue":o[1]||(o[1]=u=>n(t).current.option.private_key=u),label:r.$t("sm2_private_key")},null,8,["modelValue","label"]),e(d,{modelValue:n(t).current.option.user_id,"onUpdate:modelValue":o[2]||(o[2]=u=>n(t).current.option.user_id=u),label:r.$t("sm2_userId")},null,8,["modelValue","label"])]),_:1})]),_:1},8,["title"]),e(g,{modelValue:n(t).current.output,"onUpdate:modelValue":o[3]||(o[3]=u=>n(t).current.output=u),allow:["base64","hex"],content:c.value,height:V},null,8,["modelValue","content","height"])]),_:2},1024)]),_:1})}}});export{J as default};
