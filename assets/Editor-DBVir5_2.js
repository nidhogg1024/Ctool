import{l as b,m as y,a as V,P as L,c as M}from"./placeholderContentWidget-D4XnYn4Z.js";import{d as k,y as N,z as S,A as u,B as z,o as x,h as E,C as W,D as _,j as s,r as $,a as D,c as H,w as C,v as T,E as P,G as j,H as A,I as F,J as G,K as J}from"./tool-B4oZh9Hj.js";import"./vendor-monaco-DSX5bDTJ.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-lodash-rhkwYG98.js";const X=k({__name:"Editor",props:G({toolbar:{type:String,default:"bottom-right"},lang:{type:String,default:"text"},placeholder:{type:String,default:()=>$t("main_ui_input")},langCallback:{type:[Function,Boolean],default:()=>!1},reload:{type:Number,default:0},height:{type:[String,Number],default:"100%"},disableLineWrapping:{type:Boolean,default:!1},disableBorder:{type:Boolean,default:!1},disableLineNumbers:{type:Boolean,default:!1},disableClear:{type:Boolean,default:!1},lineInfo:{type:Boolean,default:!1}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(d){const n=N(d,"modelValue"),a=d,c=S(),f=u(null),t=z(null),m=u(!a.disableLineWrapping),p=u(!a.disableLineNumbers),g=e=>{let o=e;return a.langCallback!==!1&&(o=a.langCallback()||e),J(o)},v=async()=>{var o,l;if(!t.value)return;b(t.value).status(a.lineInfo);const e=t.value.getModel();e&&((o=y())==null||o.editor.setModelLanguage(e,g(a.lang).id)),(l=y())==null||l.editor.setTheme(c.theme.raw==="dark"?"vs-dark":"vs"),t.value.render(!0)},w=async e=>{t.value&&t.value.dispose(),V({"vs/nls":{availableLanguages:{"*":$t("main_locale")==="zh_CN"?"zh-cn":"en"}}}).then(o=>{const l=o.editor.create(e,{value:s(n.value),minimap:{enabled:!1},lineNumbers:p.value?"on":"off",wordWrap:m.value?"on":"off",language:g(a.lang).id,scrollbar:{verticalScrollbarSize:5},automaticLayout:!0});l.onDidChangeModelContent(()=>{l.getValue()!==s(n.value)&&(n.value=l.getValue())}),new L(a.placeholder,l);const h=new M(l);b(l).status(a.lineInfo),h.setHandle("ctool_line_wrapping",(B,I,i)=>m.value=i),h.setHandle("ctool_line_number",(B,I,i)=>p.value=i),t.value=l,v()})};x(async()=>{!a.disableClear&&E.addListener("content_clear",()=>r()),await w(f.value)}),W(()=>{var e;return(e=t.value)==null?void 0:e.dispose()});const r=(e="")=>{t.value&&t.value.getValue()!==e&&t.value.setValue(e)};return _(()=>({value:s(n.value)}),({value:e})=>{if(t.value)return r(e);const o=setInterval(()=>{t.value&&clearInterval(o),r(e)},50)}),_(()=>({color:c.theme.raw,lang:a.lang,reload:a.reload,lineInfo:a.lineInfo}),()=>v()),(e,o)=>{const l=$("Display");return D(),H(l,{position:a.toolbar,class:F(["ctool-code-editor",a.disableBorder?["ctool-code-editor-disable-border"]:[]]),style:j({height:`${s(A)(a.height)}`,width:"100%"}),toggle:""},{extra:C(()=>[P(e.$slots,"default")]),default:C(()=>[T("div",{ref_key:"container",ref:f,style:{height:"100%",width:"100%"}},null,512)]),_:3},8,["position","class","style"])}}});export{X as default};
