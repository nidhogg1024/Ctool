import{u as T,i as k}from"./action-CSt0YebL.js";import{d as z,y as D,z as v,A as M,k as H,v as a,w as m,r as d,B as I,f as w,j as i,F as U,q as j,c as L,C as y,T as R}from"./tool-Ct-LHwIw.js";import{C as s}from"./index-BrUbP8fJ.js";import{s as F}from"./index-B3Tv6RRh.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index-B6lDcrw6.js";import"./string_decoder-BTj07PUn.js";import"./pipeline-MENJKL-y.js";import"./readable-browser-DZk4UxY9.js";import"./index-CXcw98k8.js";import"./index-C6yxqEqs.js";const S=["md5","sha1","sha256","sha512","sm3","ripemd160"],V={md5:(r,t)=>s.HmacMD5(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha1:(r,t)=>s.HmacSHA1(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha256:(r,t)=>s.HmacSHA256(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha512:(r,t)=>s.HmacSHA512(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sm3:(r,t)=>{const h=(l,n)=>l.length>=n?l:new Array(n-l.length+1).join("0")+l;let e=r.toHexString();const _=[];let f=e.length;f%2!==0&&(e=h(e,f+1)),f=e.length;for(let l=0;l<f;l+=2)_.push(parseInt(e.substr(l,2),16));return F.sm3(_,{key:t.toHexString()})},ripemd160:(r,t)=>s.HmacRIPEMD160(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString()},A=(r,t,h)=>{if(!Object.keys(V).includes(r))throw new Error(`hmac method 不存在: ${r}`);return V[r](t,h)},ee=z({__name:"Hmac",async setup(r){let t,h;const e=T(([t,h]=D(()=>k({input:y(),secret:y("text"),is_uppercase:!1,multiple:!1})),t=await t,h(),t)),_=v(()=>["text"].includes(e.current.input.type)),f=v(()=>{let n={md5:"",sha1:"",sha256:"",sha512:"",sm3:"",ripemd160:""};if(e.current.input.text.isEmpty()||e.current.secret.text.isEmpty())return n;let o=!1;for(let u of S)try{if(e.current.input.text.isError())throw new Error(`input:${e.current.input.text.toString()}`);if(e.current.secret.text.isError())throw new Error(`secret:${e.current.secret.text.toString()}`);const c=l(u,e.current.input.text,e.current.secret.text,_.value&&e.current.multiple);n[u]=e.current.is_uppercase?c.toUpperCase():c.toLowerCase()}catch(c){o=!0,n[u]=$error(c)}return o||e.save(),n}),l=(n,o,u,c)=>c?o.toString().split(`
`).map(B=>A(n,R.fromString(B,o.encoding()),u)).join(`
`):A(n,o,u);return(n,o)=>{const u=d("TextInput"),c=d("HeightResize"),B=d("Bool"),b=d("Tooltip"),x=d("Align"),C=d("Display"),E=d("Textarea"),$=I("row");return M((w(),H("div",null,[a(x,{direction:"vertical"},{default:m(()=>[a(u,{class:"ctool-page-option",modelValue:i(e).current.secret,"onUpdate:modelValue":o[0]||(o[0]=p=>i(e).current.secret=p),"use-input":n.$t("hmac_secret"),allow:["text","hex","base64"]},null,8,["modelValue","use-input"]),a(C,null,{extra:m(()=>[a(x,null,{default:m(()=>[a(B,{size:"small",modelValue:i(e).current.is_uppercase,"onUpdate:modelValue":o[2]||(o[2]=p=>i(e).current.is_uppercase=p),border:"",label:n.$t("hmac_uppercase")},null,8,["modelValue","label"]),a(b,{content:n.$t("hmac_multiple_tooltip")},{default:m(()=>[a(B,{disabled:!_.value,size:"small",modelValue:i(e).current.multiple,"onUpdate:modelValue":o[3]||(o[3]=p=>i(e).current.multiple=p),border:"",label:n.$t("hmac_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:m(()=>[a(c,{append:[".ctool-page-option"],reduce:5},{default:m(({height:p})=>[a(u,{modelValue:i(e).current.input,"onUpdate:modelValue":o[1]||(o[1]=g=>i(e).current.input=g),height:p,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1})]),_:1})]),_:1}),a(c,null,{default:m(({height:p})=>[a(x,{direction:"vertical"},{default:m(()=>[(w(!0),H(U,null,j(i(S),g=>(w(),L(E,{"model-value":f.value[g],height:(p-20)/i(S).length,placeholder:`HMAC-${g}`,copy:`HMAC-${g}`},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[$,"10-14"]])}}});export{ee as default};
