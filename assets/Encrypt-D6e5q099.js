import{u as k,i as A}from"./action-C9DPVdj4.js";import{d as S,L as C,M as N,T as p,D as O,c as R,w as i,r as o,x as a,N as U,k as b,j as r,Q as D,O as K,P,a as d}from"./tool-COZZpXVR.js";import{r as _}from"./jsrsasign-E6zq5jeb.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-monaco-DSX5bDTJ.js";import"./vendor-lodash-rhkwYG98.js";import"./vendor-crypto-Bb1b9cxO.js";const Q=S({__name:"Encrypt",async setup(z){let l,s;const x=[{value:"RSA",label:"PKCS1"},{value:"RSAOAEP",label:"PKCS1_OAEP"}],e=k(([l,s]=C(()=>A({input:K("text"),algName:"RSA",key:"",output:D("base64")})),l=await l,s(),l)),c=N(()=>{if(e.current.input.text.isEmpty()||e.current.key.trim()==="")return p.empty();if(e.current.input.text.isError())return e.current.input.text;try{if(!e.current.input.text.isText())throw new Error("input content must text / text file");return p.fromHex(_.KJUR.crypto.Cipher.encrypt(e.current.input.text.toString(),_.KEYUTIL.getKey(e.current.key.trim()),e.current.algName))}catch(u){return p.fromError($error(u))}});return O(()=>c.value,u=>{u.isEmpty()||e.save()},{immediate:!0,deep:!0}),(u,t)=>{const g=o("Textarea"),h=o("TextInput"),y=o("TextOutput"),f=o("Select"),V=o("Display"),v=o("Align"),T=o("HeightResize"),w=P("row");return d(),R(T,{ignore:"",reduce:5},{default:i(({small:m,large:E})=>[a(v,{direction:"vertical"},{default:i(()=>[U((d(),b("div",null,[a(g,{height:m,modelValue:r(e).current.key,"onUpdate:modelValue":t[0]||(t[0]=n=>r(e).current.key=n),placeholder:u.$t("rsa_public")},null,8,["height","modelValue","placeholder"]),a(h,{modelValue:r(e).current.input,"onUpdate:modelValue":t[1]||(t[1]=n=>r(e).current.input=n),placeholder:u.$t("rsa_encrypt_input"),height:m},null,8,["modelValue","placeholder","height"])])),[[w,"1-1"]]),a(V,{position:"top-right",toggle:""},{extra:i(()=>[a(f,{size:"small",modelValue:r(e).current.algName,"onUpdate:modelValue":t[3]||(t[3]=n=>r(e).current.algName=n),options:x},null,8,["modelValue"])]),default:i(()=>[a(y,{modelValue:r(e).current.output,"onUpdate:modelValue":t[2]||(t[2]=n=>r(e).current.output=n),allow:["base64","hex"],content:c.value,height:E},null,8,["modelValue","content","height"])]),_:2},1024)]),_:2},1024)]),_:1})}}});export{Q as default};
