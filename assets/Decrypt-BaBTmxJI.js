import{u as A,i as S}from"./action-YmMChBHQ.js";import{d as E,L as C,M as N,T as p,D,c as O,w as i,r as n,x as u,N as R,k as U,j as r,Q as K,O as P,P as b,a as d}from"./tool-B4oZh9Hj.js";import{r as _}from"./jsrsasign-E6zq5jeb.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-monaco-DSX5bDTJ.js";import"./vendor-lodash-rhkwYG98.js";import"./vendor-crypto-Bb1b9cxO.js";const Q=E({__name:"Decrypt",async setup(z){let l,s;const g=[{value:"RSA",label:"PKCS1"},{value:"RSAOAEP",label:"PKCS1_OAEP"}],e=A(([l,s]=C(()=>S({input:P("base64"),algName:"RSA",key:"",output:K("text")})),l=await l,s(),l)),c=N(()=>{if(e.current.input.text.isEmpty()||e.current.key.trim()==="")return p.empty();if(e.current.input.text.isError())return e.current.input.text;try{return p.fromString(_.KJUR.crypto.Cipher.decrypt(e.current.input.text.toHexString(),_.KEYUTIL.getKey(e.current.key.trim()),e.current.algName))}catch(a){return p.fromError($error(a))}});return D(()=>c.value,a=>{a.isEmpty()||e.save()},{immediate:!0,deep:!0}),(a,t)=>{const x=n("Textarea"),h=n("TextInput"),y=n("TextOutput"),f=n("Select"),v=n("Display"),V=n("Align"),T=n("HeightResize"),k=b("row");return d(),O(T,{ignore:"",reduce:5},{default:i(({small:m,large:w})=>[u(V,{direction:"vertical"},{default:i(()=>[R((d(),U("div",null,[u(x,{height:m,modelValue:r(e).current.key,"onUpdate:modelValue":t[0]||(t[0]=o=>r(e).current.key=o),placeholder:a.$t("rsa_private")},null,8,["height","modelValue","placeholder"]),u(h,{modelValue:r(e).current.input,"onUpdate:modelValue":t[1]||(t[1]=o=>r(e).current.input=o),placeholder:a.$t("rsa_decrypt_input"),allow:["base64","hex"],height:m},null,8,["modelValue","placeholder","height"])])),[[k,"1-1"]]),u(v,{position:"top-right",toggle:""},{extra:i(()=>[u(f,{size:"small",modelValue:r(e).current.algName,"onUpdate:modelValue":t[3]||(t[3]=o=>r(e).current.algName=o),options:g},null,8,["modelValue"])]),default:i(()=>[u(y,{modelValue:r(e).current.output,"onUpdate:modelValue":t[2]||(t[2]=o=>r(e).current.output=o),content:c.value,height:w},null,8,["modelValue","content","height"])]),_:2},1024)]),_:2},1024)]),_:1})}}});export{Q as default};
