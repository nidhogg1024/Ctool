import{u as T,i as M}from"./action-BZ3Nddn_.js";import{d as k,L as D,M as H,T as z,N as I,k as v,x as a,w as m,r as d,a as w,j as u,F as U,q as j,c as L,O as V,P}from"./tool-BLEDneDs.js";import{C as s}from"./index-r0iCt40W.js";import{s as R}from"./index-CPoQnu_J.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-monaco-DSX5bDTJ.js";import"./vendor-lodash-rhkwYG98.js";import"./vendor-crypto-Bb1b9cxO.js";const S=["md5","sha1","sha256","sha512","sm3","ripemd160"],y={md5:(r,t)=>s.HmacMD5(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha1:(r,t)=>s.HmacSHA1(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha256:(r,t)=>s.HmacSHA256(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha512:(r,t)=>s.HmacSHA512(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sm3:(r,t)=>{const h=(l,n)=>l.length>=n?l:new Array(n-l.length+1).join("0")+l;let e=r.toHexString();const f=[];let _=e.length;_%2!==0&&(e=h(e,_+1)),_=e.length;for(let l=0;l<_;l+=2)f.push(parseInt(e.substr(l,2),16));return R.sm3(f,{key:t.toHexString()})},ripemd160:(r,t)=>s.HmacRIPEMD160(s.enc.Base64.parse(r.toBase64()),s.enc.Base64.parse(t.toBase64())).toString()},b=(r,t,h)=>{if(!Object.keys(y).includes(r))throw new Error(`hmac method 不存在: ${r}`);return y[r](t,h)},X=k({__name:"Hmac",async setup(r){let t,h;const e=T(([t,h]=D(()=>M({input:V(),secret:V("text"),is_uppercase:!1,multiple:!1})),t=await t,h(),t)),f=H(()=>["text"].includes(e.current.input.type)),_=H(()=>{const n={md5:"",sha1:"",sha256:"",sha512:"",sm3:"",ripemd160:""};if(e.current.input.text.isEmpty()||e.current.secret.text.isEmpty())return n;let o=!1;for(const i of S)try{if(e.current.input.text.isError())throw new Error(`input:${e.current.input.text.toString()}`);if(e.current.secret.text.isError())throw new Error(`secret:${e.current.secret.text.toString()}`);const c=l(i,e.current.input.text,e.current.secret.text,f.value&&e.current.multiple);n[i]=e.current.is_uppercase?c.toUpperCase():c.toLowerCase()}catch(c){o=!0,n[i]=$error(c)}return o||e.save(),n}),l=(n,o,i,c)=>c?o.toString().split(`
`).map(B=>b(n,z.fromString(B,o.encoding()),i)).join(`
`):b(n,o,i);return(n,o)=>{const i=d("TextInput"),c=d("HeightResize"),B=d("Bool"),A=d("Tooltip"),x=d("Align"),C=d("Display"),E=d("Textarea"),$=P("row");return I((w(),v("div",null,[a(x,{direction:"vertical"},{default:m(()=>[a(i,{class:"ctool-page-option",modelValue:u(e).current.secret,"onUpdate:modelValue":o[0]||(o[0]=p=>u(e).current.secret=p),"use-input":n.$t("hmac_secret"),allow:["text","hex","base64"]},null,8,["modelValue","use-input"]),a(C,null,{extra:m(()=>[a(x,null,{default:m(()=>[a(B,{size:"small",modelValue:u(e).current.is_uppercase,"onUpdate:modelValue":o[2]||(o[2]=p=>u(e).current.is_uppercase=p),border:"",label:n.$t("hmac_uppercase")},null,8,["modelValue","label"]),a(A,{content:n.$t("hmac_multiple_tooltip")},{default:m(()=>[a(B,{disabled:!f.value,size:"small",modelValue:u(e).current.multiple,"onUpdate:modelValue":o[3]||(o[3]=p=>u(e).current.multiple=p),border:"",label:n.$t("hmac_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:m(()=>[a(c,{append:[".ctool-page-option"],reduce:5},{default:m(({height:p})=>[a(i,{modelValue:u(e).current.input,"onUpdate:modelValue":o[1]||(o[1]=g=>u(e).current.input=g),height:p,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1})]),_:1})]),_:1}),a(c,null,{default:m(({height:p})=>[a(x,{direction:"vertical"},{default:m(()=>[(w(!0),v(U,null,j(u(S),g=>(w(),L(E,{"model-value":_.value[g],height:(p-20)/u(S).length,placeholder:`HMAC-${g}`,copy:`HMAC-${g}`},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[$,"10-14"]])}}});export{X as default};
