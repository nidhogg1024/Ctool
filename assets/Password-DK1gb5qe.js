import{u as R,i as j}from"./action-BZ3Nddn_.js";import{d as L,L as N,M as g,o as O,D as x,c as P,w as c,r as p,a as D,x as o,j as s,v as b,l as A,G as U}from"./tool-BLEDneDs.js";import"./modulepreload-polyfill-B5Qt9EMX.js";import"./vendor-mathjs-__1x7LJv.js";import"./vendor-monaco-DSX5bDTJ.js";import"./vendor-lodash-rhkwYG98.js";const G={style:{"font-size":".75rem",color:"var(--ctool-placeholder-text-color)"}},H={style:{width:"120px",height:"6px","border-radius":"3px",background:"var(--ctool-border-color)",overflow:"hidden"}},B="ABCDEFGHIJKLMNOPQRSTUVWXYZ",S="abcdefghijklmnopqrstuvwxyz",C="0123456789",v="!@#$%^&*()-_=+[]{}|;:,.<>?",I="0Oo1lI",Q=L({__name:"Password",async setup(W){let h,$;const r=R(([h,$]=N(()=>j({length:16,amount:5,uppercase:!0,lowercase:!0,digits:!0,symbols:!0,excludeAmbiguous:!1,ensureEachType:!0,result:[]})),h=await h,$(),h)),_=e=>{const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]%e},w=e=>e.split("").filter(t=>!I.includes(t)).join(""),V=()=>{const e=r.current;let t="";const n=[];if(e.uppercase){const u=e.excludeAmbiguous?w(B):B;t+=u,n.push(u)}if(e.lowercase){const u=e.excludeAmbiguous?w(S):S;t+=u,n.push(u)}if(e.digits){const u=e.excludeAmbiguous?w(C):C;t+=u,n.push(u)}if(e.symbols&&(t+=v,n.push(v)),t.length===0)return;const f=[];for(let u=0;u<e.amount;u++){const a=[];if(e.ensureEachType&&e.length>=n.length)for(const i of n)a.push(i[_(i.length)]);for(;a.length<e.length;)a.push(t[_(t.length)]);for(let i=a.length-1;i>0;i--){const d=_(i+1);[a[i],a[d]]=[a[d],a[i]]}f.push(a.join(""))}r.current.result=f},M=g(()=>r.current.result.join(`
`)),y=g(()=>{const e=r.current.length;let t=0;if(r.current.uppercase&&(t+=26),r.current.lowercase&&(t+=26),r.current.digits&&(t+=10),r.current.symbols&&(t+=v.length),t===0)return 0;r.current.excludeAmbiguous&&(t=Math.max(t-I.length,1));const n=e*Math.log2(t);return n<28?Math.max(n/28*2.5,.5):n<48?2.5+(n-28)/20*2.5:n<80?5+(n-48)/32*3:Math.min(8+(n-80)/40*2,10)}),T=g(()=>y.value*10),z=g(()=>{const e=y.value;return e<3?"#f56c6c":e<5?"#e6a23c":e<8?"#67c23a":"#409eff"}),k=g(()=>{const e=y.value;return e<3?$t("password_strength_weak"):e<5?$t("password_strength_medium"):e<8?$t("password_strength_strong"):$t("password_strength_very_strong")});return O(()=>{r.current.result.length<1&&V()}),x(()=>({l:r.current.length,a:r.current.amount,u:r.current.uppercase,lo:r.current.lowercase,d:r.current.digits,s:r.current.symbols,e:r.current.excludeAmbiguous,en:r.current.ensureEachType}),()=>V()),x(()=>r.current,e=>{e.result.length>0&&r.save()},{deep:!0}),(e,t)=>{const n=p("Textarea"),f=p("HeightResize"),u=p("InputNumber"),a=p("Icon"),i=p("Button"),d=p("Align"),m=p("Bool"),E=p("Card");return D(),P(d,{direction:"vertical"},{default:c(()=>[o(f,{reduce:5,append:[".ctool-page-option"]},{default:c(({height:l})=>[o(n,{height:l,"model-value":M.value,placeholder:e.$t("main_ui_output")},null,8,["height","model-value","placeholder"])]),_:1}),o(E,{class:"ctool-page-option",padding:"0"},{default:c(()=>[o(d,{horizontal:"center",style:{padding:"10px 16px"},direction:"vertical"},{default:c(()=>[o(d,{horizontal:"center"},{default:c(()=>[o(u,{modelValue:s(r).current.length,"onUpdate:modelValue":t[0]||(t[0]=l=>s(r).current.length=l),width:100,label:e.$t("password_length"),min:4,max:128},null,8,["modelValue","label"]),o(u,{modelValue:s(r).current.amount,"onUpdate:modelValue":t[1]||(t[1]=l=>s(r).current.amount=l),width:100,label:e.$t("password_amount"),min:1,max:100},null,8,["modelValue","label"]),o(i,{onClick:V},{default:c(()=>[o(a,{name:"refresh"})]),_:1})]),_:1}),o(d,{horizontal:"center"},{default:c(()=>[o(m,{modelValue:s(r).current.uppercase,"onUpdate:modelValue":t[2]||(t[2]=l=>s(r).current.uppercase=l),label:`${e.$t("password_uppercase")} (A-Z)`,size:"small",border:""},null,8,["modelValue","label"]),o(m,{modelValue:s(r).current.lowercase,"onUpdate:modelValue":t[3]||(t[3]=l=>s(r).current.lowercase=l),label:`${e.$t("password_lowercase")} (a-z)`,size:"small",border:""},null,8,["modelValue","label"]),o(m,{modelValue:s(r).current.digits,"onUpdate:modelValue":t[4]||(t[4]=l=>s(r).current.digits=l),label:`${e.$t("password_digits")} (0-9)`,size:"small",border:""},null,8,["modelValue","label"]),o(m,{modelValue:s(r).current.symbols,"onUpdate:modelValue":t[5]||(t[5]=l=>s(r).current.symbols=l),label:`${e.$t("password_symbols")} (!@#$)`,size:"small",border:""},null,8,["modelValue","label"])]),_:1}),o(d,{horizontal:"center"},{default:c(()=>[o(m,{modelValue:s(r).current.excludeAmbiguous,"onUpdate:modelValue":t[6]||(t[6]=l=>s(r).current.excludeAmbiguous=l),label:e.$t("password_exclude_ambiguous"),size:"small",border:""},null,8,["modelValue","label"]),o(m,{modelValue:s(r).current.ensureEachType,"onUpdate:modelValue":t[7]||(t[7]=l=>s(r).current.ensureEachType=l),label:e.$t("password_ensure_each_type"),size:"small",border:""},null,8,["modelValue","label"])]),_:1}),o(d,{horizontal:"center"},{default:c(()=>[b("span",G,A(e.$t("password_strength"))+":",1),b("span",{style:U({fontSize:".875rem",fontWeight:"bold",color:z.value})},A(k.value),5),b("div",H,[b("div",{style:U({width:`${T.value}%`,height:"100%",borderRadius:"3px",background:z.value,transition:"all 0.3s"})},null,4)])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Q as default};
