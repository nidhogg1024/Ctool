import{K as _,N as j}from"./tool-BVT50QXb.js";import{B as v}from"./base-C4lZah3o.js";import"./modulepreload-polyfill-B5Qt9EMX.js";var T={exports:{}},b={exports:{}};(function(S,p){Object.defineProperty(p,"__esModule",{value:!0}),p.ParsingError=void 0;class g extends Error{constructor(o,r){super(o),this.cause=r}}p.ParsingError=g;let i;function m(){return C(!1)||y()||E()||O()}function w(){return e(/\s*/),C(!0)||E()||P()||x(!1)}function u(){const t=x(!0),o=[];let r,c=w();for(;c;){if(c.node.type==="Element"){if(r)throw new Error("Found multiple root nodes");r=c.node}c.excluded||o.push(c.node),c=w()}if(!r)throw new g("Failed to parse XML","Root Element not found");if(i.xml.length!==0)throw new g("Failed to parse XML","Not Well-Formed XML");return{declaration:t?t.node:null,root:r,children:o}}function x(t){const o=e(t?/^<\?(xml)\s*/:/^<\?([\w-:.]+)\s*/);if(!o)return;const r={name:o[1],type:"ProcessingInstruction",attributes:{}};for(;!(l()||s("?>"));){const c=h();if(c)r.attributes[c.name]=c.value;else return}return e(/\?>/),{excluded:t?!1:i.options.filter(r)===!1,node:r}}function C(t){const o=e(/^<([^?!</>\s]+)\s*/);if(!o)return;const r={type:"Element",name:o[1],attributes:{},children:[]},c=t?!1:i.options.filter(r)===!1;for(;!(l()||s(">")||s("?>")||s("/>"));){const d=h();if(d)r.attributes[d.name]=d.value;else return}if(e(/^\s*\/>/))return r.children=null,{excluded:c,node:r};e(/\??>/);let f=m();for(;f;)f.excluded||r.children.push(f.node),f=m();if(i.options.strictMode){const d=`</${r.name}>`;if(i.xml.startsWith(d))i.xml=i.xml.slice(d.length);else throw new g("Failed to parse XML",`Closing tag not matching "${d}"`)}else e(/^<\/[\w-:.\u00C0-\u00FF]+\s*>/);return{excluded:c,node:r}}function P(){const t=e(/^<!DOCTYPE\s+\S+\s+SYSTEM[^>]*>/)||e(/^<!DOCTYPE\s+\S+\s+PUBLIC[^>]*>/)||e(/^<!DOCTYPE\s+\S+\s*\[[^\]]*]>/)||e(/^<!DOCTYPE\s+\S+\s*>/);if(t){const o={type:"DocumentType",content:t[0]};return{excluded:i.options.filter(o)===!1,node:o}}}function O(){if(i.xml.startsWith("<![CDATA[")){const t=i.xml.indexOf("]]>");if(t>-1){const o=t+3,r={type:"CDATA",content:i.xml.substring(0,o)};return i.xml=i.xml.slice(o),{excluded:i.options.filter(r)===!1,node:r}}}}function E(){const t=e(/^<!--[\s\S]*?-->/);if(t){const o={type:"Comment",content:t[0]};return{excluded:i.options.filter(o)===!1,node:o}}}function y(){const t=e(/^([^<]+)/);if(t){const o={type:"Text",content:t[1]};return{excluded:i.options.filter(o)===!1,node:o}}}function h(){const t=e(/([^=]+)\s*=\s*("[^"]*"|'[^']*'|[^>\s]+)\s*/);if(t)return{name:t[1].trim(),value:n(t[2].trim())}}function n(t){return t.replace(/^['"]|['"]$/g,"")}function e(t){const o=i.xml.match(t);if(o)return i.xml=i.xml.slice(o[0].length),o}function l(){return i.xml.length===0}function s(t){return i.xml.indexOf(t)===0}function a(t,o={}){t=t.trim();const r=o.filter||(()=>!0);return i={xml:t,options:Object.assign(Object.assign({},o),{filter:r,strictMode:o.strictMode===!0})},u()}S.exports=a,p.default=a})(b,b.exports);var F=b.exports;(function(S,p){var g=j&&j.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(p,"__esModule",{value:!0});const i=g(F);function m(n){if(!n.options.indentation&&!n.options.lineSeparator)return;n.content+=n.options.lineSeparator;let e;for(e=0;e<n.level;e++)n.content+=n.options.indentation}function w(n){n.content=n.content.replace(/ +$/,"");let e;for(e=0;e<n.level;e++)n.content+=n.options.indentation}function u(n,e){n.content+=e}function x(n,e,l){if(typeof n.content=="string")C(n.content,e,l);else if(n.type==="Element")O(n,e,l);else if(n.type==="ProcessingInstruction")y(n,e);else throw new Error("Unknown node type: "+n.type)}function C(n,e,l){if(!l){const s=n.trim();(e.options.lineSeparator||s.length===0)&&(n=s)}n.length>0&&(!l&&e.content.length>0&&m(e),u(e,n))}function P(n,e){const l="/"+n.join("/"),s=n[n.length-1];return e.includes(s)||e.includes(l)}function O(n,e,l){if(e.path.push(n.name),!l&&e.content.length>0&&m(e),u(e,"<"+n.name),E(e,n.attributes),n.children===null||e.options.forceSelfClosingEmptyTag&&n.children.length===0){const s=e.options.whiteSpaceAtEndOfSelfclosingTag?" />":"/>";u(e,s)}else if(n.children.length===0)u(e,"></"+n.name+">");else{const s=n.children;u(e,">"),e.level++;let a=n.attributes["xml:space"]==="preserve",t=!1;if(!a&&e.options.ignoredPaths&&(t=P(e.path,e.options.ignoredPaths),a=t),!a&&e.options.collapseContent){let o=!1,r=!1,c=!1;s.forEach(function(f,d){f.type==="Text"?(f.content.includes(`
`)?(r=!0,f.content=f.content.trim()):(d===0||d===s.length-1)&&!l&&f.content.trim().length===0&&(f.content=""),f.content.trim().length>0&&(o=!0)):f.type==="CDATA"?o=!0:c=!0}),o&&(!c||!r)&&(a=!0)}s.forEach(function(o){x(o,e,l||a)}),e.level--,!l&&!a&&m(e),t&&w(e),u(e,"</"+n.name+">")}e.path.pop()}function E(n,e){Object.keys(e).forEach(function(l){const s=e[l].replace(/"/g,"&quot;");u(n," "+l+'="'+s+'"')})}function y(n,e){e.content.length>0&&m(e),u(e,"<?"+n.name),E(e,n.attributes),u(e,"?>")}function h(n,e={}){e.indentation="indentation"in e?e.indentation:"    ",e.collapseContent=e.collapseContent===!0,e.lineSeparator="lineSeparator"in e?e.lineSeparator:`\r
`,e.whiteSpaceAtEndOfSelfclosingTag=e.whiteSpaceAtEndOfSelfclosingTag===!0,e.throwOnFailure=e.throwOnFailure!==!1;try{const l=(0,i.default)(n,{filter:e.filter,strictMode:e.strictMode}),s={content:"",level:0,options:e,path:[]};return l.declaration&&y(l.declaration,s),l.children.forEach(function(a){x(a,s,!1)}),e.lineSeparator?s.content.replace(/\r\n/g,`
`).replace(/\n/g,e.lineSeparator):s.content}catch(l){if(e.throwOnFailure)throw l;return n}}h.minify=(n,e={})=>h(n,Object.assign(Object.assign({},e),{indentation:"",lineSeparator:""})),S.exports=h,p.default=h})(T,T.exports);var D=T.exports;const M=_(D),X=new class extends v{async beautify(){return M(this.code,{indentation:" ".repeat(this.getOptionValue("tab",4)),collapseContent:this.getOptionValue("collapse_content",!1),lineSeparator:`
`})}async compress(){return M(this.code,{indentation:"",collapseContent:!0,lineSeparator:""})}};export{X as formatter};
