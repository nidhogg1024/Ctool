import{u as A,i as C}from"./action-CxHrJ3x4.js";import{d as $,y as V,I as E,D as j,c as x,w as h,r as c,f as T,v as s,j as l}from"./tool-mWZXxcAE.js";import"./modulepreload-polyfill-B5Qt9EMX.js";const z=$({__name:"Encoder",async setup(I){let d,y;const f=[{value:"HS256",label:"HS256"},{value:"HS384",label:"HS384"},{value:"HS512",label:"HS512"}],H={HS256:"SHA-256",HS384:"SHA-384",HS512:"SHA-512"},n=A(([d,y]=V(()=>C({payload:"",secret:"",algorithm:"HS256"},{paste:!1})),d=await d,y(),d)),g=t=>{let e;typeof t=="string"?e=new TextEncoder().encode(t):e=new Uint8Array(t);let a="";for(const o of e)a+=String.fromCharCode(o);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},w=async(t,e,a)=>{const o=new TextEncoder,r=await crypto.subtle.importKey("raw",o.encode(e),{name:"HMAC",hash:H[t]},!1,["sign"]),i=await crypto.subtle.sign("HMAC",r,o.encode(a));return g(i)},S=async(t,e,a)=>{const o=JSON.stringify({alg:t,typ:"JWT"}),r=g(o);JSON.parse(e);const i=g(e),m=`${r}.${i}`,_=await w(t,a,m);return`${m}.${_}`};let p=E("");return j(()=>({payload:n.current.payload,secret:n.current.secret,algorithm:n.current.algorithm}),async({payload:t,secret:e,algorithm:a})=>{p.value="";const o=t.trim();if(!(!o||!e))try{p.value=await S(a,o,e),n.save()}catch(r){p.value=$error(r)}},{immediate:!0,deep:!0}),(t,e)=>{const a=c("Select"),o=c("Input"),r=c("Align"),i=c("Editor"),m=c("Textarea"),_=c("HeightResize");return T(),x(_,{reduce:5},{default:h(({small:v,large:b})=>[s(r,{direction:"vertical"},{default:h(()=>[s(i,{modelValue:l(n).current.payload,"onUpdate:modelValue":e[2]||(e[2]=u=>l(n).current.payload=u),lang:"json",height:v,placeholder:t.$t("jwt_payload_placeholder")},{default:h(()=>[s(r,null,{default:h(()=>[s(a,{"model-value":l(n).current.algorithm,onChange:e[0]||(e[0]=u=>l(n).current.algorithm=u),options:f},null,8,["model-value"]),s(o,{modelValue:l(n).current.secret,"onUpdate:modelValue":e[1]||(e[1]=u=>l(n).current.secret=u),placeholder:t.$t("jwt_secret_placeholder"),width:200},null,8,["modelValue","placeholder"])]),_:1})]),_:2},1032,["modelValue","height","placeholder"]),s(m,{"model-value":l(p),height:b,placeholder:t.$t("jwt_output_placeholder"),copy:""},null,8,["model-value","height","placeholder"])]),_:2},1024)]),_:1})}}});export{z as default};
